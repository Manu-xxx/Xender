### Pre-Handle Workflow

The `prehandle` package contains the workflow for pre-handling transactions. A rough overview can be seen in the diagram below.

![Diagram of pre-handle transaction workflow](images/Pre-Handle%20Transaction%20Workflow.png)

An `Event` at a time is sent to the `prehandle` with a reference to the latest immutable state. It iterates through each transaction and initiates the pre-handle workflow in a separate thread. The workflow consists of the following steps:

0. **Parse Transaction.** The transaction arrives as a byte-array. The required parts are parsed and the common information is validated.
1. **Call PreTransactionHandler.** Depending on the type of transaction, a specific `PreTransactionHandler` is called. It validates the transaction-specific parts and pre-loads data into the cache. It also creates a `TransactionMetadata` and fills the required keys.
2. **Check Signature Map.** The signature of all required keys are checked and prepared for verification.
3. **Verify Signatures.** All required information is sent to the platform to validate the signatures.
4. **Transaction Metadata.** If all checks were successful, the `TransactionMetadata` generated by the `PreTransactionHandler` is attached to the `Swirldstransaction`.

If at any point during the workflow an error occurs, the status of the returned `TransactionMetadata` signals the error. Eventually the causing `Exception` is also provided.
